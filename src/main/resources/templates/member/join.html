<!-- <!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Join</title>
    Favicon
    <link rel="icon" type="image/x-icon" href="/assets/img/icon.png" />
    Font Awesome icons (free version)
    <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
    Google fonts
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
    Core theme CSS (includes Bootstrap)
    <link href="/css/styles.css" rel="stylesheet" />
    <link href="/css/join.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body id="page-top">
  Navigation
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">
          <a class="navbar-brand" href="/"><img src="/assets/img/logo_2.png" alt="..." /></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
              Menu
              <i class="fas fa-bars ms-1"></i>
          </button>
          <div class="collapse navbar-collapse" id="navbarResponsive">
              <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
                <li class="nav-item"><a class="nav-link" href="/page/enroll">공연등록</a></li>
                <li class="nav-item"><a class="nav-link" href="/members/login" id="login_tab">로그인</a></li>
                <li class="nav-item"><a class="nav-link" href="/members/sign_up" id="sign_up_tab">회원가입</a></li>
                <li class="nav-item"><a class="nav-link" href="/members/page/mypage">마이페이지</a></li>
              </ul>
          </div>
      </div>
  </nav>
  Masthead
  <header class="masthead">
    <div class="container">
      <div class="join-wrapper">
            <h2>회원가입</h2>
            <form method="post" action="/members/join" id="login-form" name="sign-up">            
                <h5 class="form-text">이메일</h5>
                <input type="text" name="email" id="email" placeholder="busker@example.com" required>
                
                <h5 class="form-text">비밀번호</h5>
                <input type="password" name="password" id="password" placeholder="Password" 
                required maxlength="16" onchange="psLengthCheck()">

                <h5 class="form-text">비밀번호 확인</h5>
                <input type="password" name="confirmPassword" id="confirmPassword"
                 placeholder="Confirm Password" required maxlength="16" onchange="psReCheck()">
                
                
                <input type="submit" value="Sign up" id="submit" name="submit">
            </form>
        </div>
    </div>
  </header>
  
  Bootstrap core JS
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  Core theme JS
  <script src="/js/scripts.js"></script>
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  * *                               SB Forms JS                               * *
  * * Activate your form at https://startbootstrap.com/solution/contact-forms * *
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
</body>  
</html>
<script>
	var password = document.getElementById('password');
	var confirmPassword = document.getElementById('confirmPassword');
	var email = document.getElementById('email');
	var psTxt = document.getElementById('psTxt');
	var joinWrapper = document.getElementById('joinWrapper');
	var emailCheckTxt = document.getElementById('emailCheckTxt');
	
	// password와 confirmPassword의 일치 여부 확인
	function psReCheck() {
	    if (password.value != confirmPassword.value) {
	        confirmPassword.setCustomValidity("비밀번호가 일치하지 않습니다.");
	    }
	    else {
	        confirmPassword.setCustomValidity("");
	    }
	}
	confirmPassword.onkeyup = psReCheck();
	
	
	// password는 4자 이상 ~ 16자 이하의 값
	function psLengthCheck() {
	    if (password.value.length < 4) {
	        password.setCustomValidity("네 글자 이상 입력해주세요.");
	    }
	    else {
	        password.setCustomValidity("");
	    }
	}
	password.onkeyup = psLengthCheck();
	
	
	$("#email").on("blur", function () {
	    let email = document.getElementById("email");
	    $.ajax({
	        url: "/members/emailCheck?email=" + email.value,
	        type: "GET",
	        async: true
	    })
	    .done(function (data) {
	
	                email.style.marginBottom = "8px";
	                psTxt.style.marginTop = "40px";
	                joinWrapper.style.height = "480px";
	
	                if (data.isValid === true) { // 이메일 값 중복x
	                    emailCheckTxt.style.color = "green";
	                    emailCheckTxt.innerHTML = "사용 가능한 이메일입니다.";
	                    submit.disabled = false;
	                }
	                else if (data.isValid === false) {  // 이메일 중복일 때
	                    emailCheckTxt.style.color = "red";
	                    emailCheckTxt.innerHTML = "이미 가입된 이메일입니다.";
	                    let submit = document.getElementById("submit");
	                    submit.disabled = true;
	                }
	
	            }
	    )
	});

	$.ajax({
		url: "/members/loginCheck",
		type: "GET",
		
		success: function (data) {
			console.log(data.isLogin);
			if (data.isLogin == null){
				document.getElementById('login_tab').style.display='block';
				document.getElementById('sign_up_tab').style.display='block';
	
			}
			else{
				document.getElementById('login_tab').style.display='none';
				document.getElementById('sign_up_tab').style.display='none';
			}
		},
		error: function (xhr, status, error) {
			alert(xhr.responseText);
		},
		complete: function (xhr, status) { }
	});
</script> -->
<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Join</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="/assets/img/icon.png" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/css/styles.css" rel="stylesheet" />
    <link href="/css/join.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>

<body id="page-top">
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
    <div class="container">
        <a class="navbar-brand" href="/"><img src="/assets/img/logo_2.png" alt="..." /></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="fas fa-bars ms-1"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
                <li class="nav-item"><a class="nav-link" href="/page/enroll">공연등록</a></li>
                <li class="nav-item"><a class="nav-link" href="/members/login" id="login_tab">로그인</a></li>
                <li class="nav-item"><a class="nav-link" href="/members/join" id="join_tab">회원가입</a></li>
                <li class="nav-item"><a class="nav-link" href="/members/logout" id="logout_tab">로그아웃</a></li>
                <li class="nav-item"><a class="nav-link" href="/mypage">마이페이지</a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- Masthead-->
<header class="masthead">
    <div class="container">
        <div class="join-wrapper" id="joinWrapper">
            <h2>회원가입</h2>
            <form method="post" action="/members/join" id="login-form" name="sign-up">

                <h5 class="form-text">이메일</h5>
                <input type="text" name="email" id="email" placeholder="busker@example.com" required>
                <p id="emailCheckTxt"></p>

                <h5 class="form-text" id="psTxt">비밀번호</h5>
                <input type="password" name="password" id="password" placeholder="Password" required maxlength="16"
                       onchange="psLengthCheck()">

                <h5 class="form-text">비밀번호 확인</h5>
                <input type="password" name="confirmPassword" id="confirmPassword" placeholder="Confirm Password" required
                       maxlength="16" onchange="psReCheck()">


                <input type="submit" value="Sign up" id="submit" name="submit">
            </form>
        </div>
    </div>
</header>

<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="/js/scripts.js"></script>
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<!-- * *                               SB Forms JS                               * *-->
<!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>

<script>

    var password = document.getElementById('password');
    var confirmPassword = document.getElementById('confirmPassword');
    var email = document.getElementById('email');
    var psTxt = document.getElementById('psTxt');
    var joinWrapper = document.getElementById('joinWrapper');
    var emailCheckTxt = document.getElementById('emailCheckTxt');

    // password와 confirmPassword의 일치 여부 확인
    function psReCheck() {
        if (password.value != confirmPassword.value) {
            confirmPassword.setCustomValidity("비밀번호가 일치하지 않습니다.");
        }
        else {
            confirmPassword.setCustomValidity("");
        }
    }
    confirmPassword.onkeyup = psReCheck();


    // password는 4자 이상 ~ 16자 이하의 값
    function psLengthCheck() {
        if (password.value.length < 4) {
            password.setCustomValidity("네 글자 이상 입력해주세요.");
        }
        else {
            password.setCustomValidity("");
        }
    }
    password.onkeyup = psLengthCheck();


    $("#email").on("blur", function () {
        let email = document.getElementById("email");
        $.ajax({
            url: "/members/emailCheck?email=" + email.value,
            type: "GET",
            async: true
        })
        .done(function (data) {

                    email.style.marginBottom = "8px";
                    psTxt.style.marginTop = "40px";
                    joinWrapper.style.height = "480px";

                    if (data.isValid === true) { // 이메일 값 중복x
                        emailCheckTxt.style.color = "green";
                        emailCheckTxt.innerHTML = "사용 가능한 이메일입니다.";
                        submit.disabled = false;
                    }
                    else if (data.isValid === false) {  // 이메일 중복일 때
                        emailCheckTxt.style.color = "red";
                        emailCheckTxt.innerHTML = "이미 가입된 이메일입니다.";
                        let submit = document.getElementById("submit");
                        submit.disabled = true;
                    }

                }
        )
    });
    $.ajax({
    	url: "/members/loginCheck",
    	type: "GET",
    	
    	success: function (data) {
    		console.log(data.isLogin);
    		if (data.isLogin == null){
    			document.getElementById('login_tab').style.display='block';
    			document.getElementById('join_tab').style.display='block';
    			document.getElementById('logout_tab').style.display='none';

    		}
    		else{
    			document.getElementById('login_tab').style.display='none';
    			document.getElementById('join_tab').style.display='none';
    			document.getElementById('logout_tab').style.display='block';
    		}
    	},
    	error: function (xhr, status, error) {
    		alert(xhr.responseText);
    	},
    	complete: function (xhr, status) { }
    });

</script>
</body>

</html>